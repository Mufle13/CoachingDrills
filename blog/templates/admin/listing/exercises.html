{% extends 'admin/back_base.html' %}
{% load custom_tag  %}
{% block title %} <title>Exercises</title> {% endblock %}
    
{%block content %}
    <div class="header">
        <h1>Exercises</h1>
        <div class="add-button">
            <a href="{% url 'adding_exercise' %}">
                <span class="material-icons">add_circle</span>
                <span>Add an exercise</span>
            </a>
        </div>
    </div>
    <div>
        <p>Filters</p>
    </div>
    <form method="GET">
        <div class='filters'>
            {% for field in form %}
                <label class='filter-label'>{{ field.label }}</label>
                {% if field.name == 'categories' %}
                <div class='filter-categories'>
                    {% for choice in form.categories %}
                        {{ choice.tag }}
                        <label for="{{ choice.id_for_label }}">{{ choice.choice_label }}</label>
                    {% endfor %}
                </div>
                {% elif field.name == 'tags' %}
                <div class='filter-tags'>
                    {% for choice in form.tags %}
                        {{ choice.tag }}
                        <label for="{{ choice.id_for_label }}">{{ choice.choice_label }}</label>
                    {% endfor %} 
                </div>
                {% elif field.name == 'research' %}
                <div class='filter-research'>
                    <span> {{ field }}</span>
                </div> 
                {% endif %}
            {% endfor %} 
            <div class=filter-button> 
                <input type="submit" value='Filter'>
            </div>
        </div>  
    </form>
    {% if not exercises %}
    <p>No result</p>
    {% else %}
    <div id=list>
        <table>
            <thead class="table-header">
                <tr>
                    <th>Name <a href="?{% add_sortreverse 'name' %}">&#x25B2</a><a href="?{% add_sort 'name' %}">&#x25BC</a></th>
                    <th>Category <a href="?{% add_sortreverse 'category' %}">&#x25B2</a><a href="?{% add_sort 'category' %}">&#x25BC</a></th>
                    <th>Tags <a href="?{% add_sortreverse 'tag' %}">&#x25B2</a><a href="?{% add_sort 'tag' %}">&#x25BC</a></th>
                    <th>Difficulty <a href="?{% add_sortreverse 'difficulty' %}">&#x25B2</a><a href="?{% add_sort 'difficulty' %}">&#x25BC</a></th>
                    <th>Number of players <a href="?{% add_sortreverse 'number_of_player' %}">&#x25B2</a><a href="?{% add_sort 'number_of_player' %}">&#x25BC</a></th>
                    <th>Duration (in min.) <a href="?{% add_sortreverse 'duration' %}">&#x25B2</a><a href="?{% add_sort 'duration' %}">&#x25BC</a></th> 
                    <th></th>
                    <th></th>              
                </tr>
            </thead>
            {% for exercise in page_obj %}
            <tbody>
                <tr class="listing">
                    <td><a href="{% url 'exercise_detail' pk=exercise.pk %}">{{ exercise.name }}</a></td>
                    <td>{{ exercise.category }}</td>
                    <td class="tags">{% for tag in exercise.tag.all %}
                        <div>{{ tag.name }}</div>
                    {% endfor %}</td>
                    <td>{{ exercise.difficulty }}</td>
                    <td>{{ exercise.number_of_player }}</td>
                    <td>{{ exercise.duration }}</td>
                    <td><a class="edit" href="{% url 'edit_exercise' pk=exercise.pk %}">Edit</a></td>
                    <td><a class="delete" href="{% url 'delete_exercise' pk=exercise.pk %}">Delete</a></td>
                </tr>
            </tbody>
            {% endfor %}
        </table>
        <div class='count'>
        <span>{{ exercises_count }} exercises</span>
        </div>
        <div class="pagination">
            <span class="pages">
                {% if page_obj.has_previous %}
                    <a href="?{% replace_page 1 %}">&#171</a>
                    <a href="?{% replace_page page_obj.previous_page_number %}">{{ page_obj.previous_page_number }}</a>
                {% endif %}
        
                
            <span class="current">{{ page_obj.number }}</span>
                
        
                {% if page_obj.has_next %}
                    <a href="?{% replace_page page_obj.next_page_number %}">{{ page_obj.next_page_number }}</a>
                    <a href="?{% replace_page page_obj.paginator.num_pages %}">&#187</a>
                {% endif %}
            </span>
        </div>   
    </div>
    {% endif %}
{% endblock %}